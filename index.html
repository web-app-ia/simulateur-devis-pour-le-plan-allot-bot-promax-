<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulateur de Devis ALLO-BOT - Agent Vocal IA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a237e 0%, #283593 50%, #3949ab 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
        }


        h1 {
            text-align: center;
            color: #1a237e;
            margin-bottom: 10px;
            font-size: 2.5em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .logo {
            font-size: 0.6em;
            background: linear-gradient(135deg, #1a237e, #3949ab);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 900;
        }

        .back-button {
            position: absolute;
            top: 40px;
            right: 40px;
            padding: 10px 20px;
            background: #e8eaf6;
            color: #1a237e;
            text-decoration: none;
            border-radius: 50px;
            font-weight: 700;
            font-size: 0.9em;
            border: 2px solid #c5cae9;
            transition: all 0.3s ease;
        }
        .back-button:hover {
            background: #c5cae9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        /* Header logo image */
        .header-logo {
            width: 56px;
            height: 56px;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15);
            display: inline-block;
            vertical-align: middle;
        }

        .footer-images {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-top: 18px;
            align-items: center;
        }

        .footer-images img {
            max-width: 720px; /* larger */
            width: 48%;
            height: auto;
            border-radius: 8px;
            box-shadow: 0 6px 18px rgba(0,0,0,0.12);
        }

        .footer-contact {
            text-align: center;
            margin-top: 12px;
            font-weight: 700;
            color: #333;
            font-size: 0.95em;
        }

        .promo-subtitle {
            text-align: center;
            color: #dc2626; /* Rouge */
            font-weight: bold;
            font-size: 1.1em; /* Taille r√©duite pour tenir sur une ligne */
            font-size: 1.1em; /* Taille r√©duite pour tenir sur une ligne */
            margin-bottom: 10px;
        }

        /* Overlay pour bloquer l'acc√®s sur petits √©crans */
        .mobile-block-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.98);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            padding: 20px;
        }

        .mobile-block-overlay.visible {
            display: flex;
        }

        .mobile-block-overlay .message {
            max-width: 720px;
            background: #fff;
            padding: 24px;
            border-radius: 12px;
            border: 3px solid #ffeb3b;
            box-shadow: 0 8px 30px rgba(0,0,0,0.15);
            text-align: center;
            color: #333;
            font-size: 1.05em;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 40px;
            font-size: 1.1em;
        }

        .config-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.5em;
            color: #1a237e;
            margin-bottom: 20px;
            border-bottom: 3px solid #3949ab;
            padding-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            font-size: 1.05em;
        }

        input[type="number"], select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        input[type="number"]:focus, select:focus {
            outline: none;
            border-color: #1a237e;
        }

        .toggle-checkbox {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 20px 0;
            padding: 15px;
            background: #e8eaf6;
            border-radius: 10px;
            border-left: 5px solid #3949ab;
        }

        .toggle-checkbox input[type="checkbox"] {
            width: 24px;
            height: 24px;
            cursor: pointer;
        }

        .toggle-checkbox label {
            margin: 0;
            cursor: pointer;
            font-weight: 600;
            color: #1a237e;
        }

        .week-container {
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            border: 2px solid #3949ab;
        }

        .week-title {
            font-size: 1.3em;
            color: #1a237e;
            margin-bottom: 15px;
            font-weight: 700;
            text-align: center;
        }

        .week-schedule {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .day-card {
            background: linear-gradient(135deg, #fff 0%, #e8eaf6 100%);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border: 1px solid #c5cae9;
        }

        .day-name {
            font-weight: 700;
            color: #1a237e;
            margin-bottom: 15px;
            font-size: 1.2em;
            text-align: center;
            padding: 10px;
            background: #e8eaf6;
            border-radius: 8px;
        }

        .hour-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(45px, 1fr));
            gap: 8px;
            margin-top: 15px;
        }

        .hour-slot {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .hour-label {
            font-size: 0.75em;
            color: #666;
            text-align: center;
            font-weight: 600;
        }

        .hour-input {
            text-align: center;
            padding: 6px 2px;
            font-size: 0.85em;
            border: 1px solid #c5cae9;
            border-radius: 4px;
            transition: all 0.2s;
            width: 100%;
            box-sizing: border-box;
        }

        /* Suppression des boutons de d√©filement pour tous les champs num√©riques */
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button,
        input::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"],
        input.hour-input,
        input.pause-time {
            -moz-appearance: textfield;
        }

        .hour-cell {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .pause-time {
            width: 40px;
            padding: 3px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.8em;
            background-color: #fffde7;
        }

        .hour-input {
            width: 100%;
            padding: 5px 2px;
            text-align: center;
            border: 1px solid #3949ab;
            border-radius: 4px;
            font-size: 0.85em;
            background-color: #ffffff;
        }

        .hour-input:focus, .pause-time:focus {
            border-color: #1a237e;
            background-color: #e8eaf6;
            outline: none;
        }

        .pause-time[data-customized="true"] {
            background-color: #e3f2fd;
            border-color: #1a237e;
        }

        .pause-label {
            font-size: 0.7em;
            color: #666;
            text-align: center;
        }

        .storage-config {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .pricing-info {
            background: #e3f2fd;
            border-left: 5px solid #2196f3;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            font-size: 0.9em;
        }

        .pricing-info.warning {
            background: #e8eaf6;
            border-left-color: #3949ab;
        }

        .pricing-info.success {
            background: #e8f5e9;
            border-left-color: #4caf50;
        }

        .free-tier-badge {
            display: inline-block;
            background: #4caf50;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 600;
            margin-left: 10px;
        }

        .paid-tier-badge {
            display: inline-block;
            background: #3949ab;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 600;
            margin-left: 10px;
        }

        .calculate-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin: 40px 0;
        }

        .btn-calculate {
            background: linear-gradient(135deg, #1a237e 0%, #3949ab 100%);
            color: white;
            border: none;
            padding: 18px 50px;
            font-size: 1.3em;
            font-weight: 700;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(26, 35, 126, 0.4);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .btn-calculate:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(26, 35, 126, 0.6);
        }

        .monthly-fee {
            background: white;
            border: 3px solid #1a237e;
            padding: 15px 30px;
            border-radius: 15px;
            font-size: 1.1em;
            font-weight: 600;
            color: #1a237e;
            box-shadow: 0 4px 15px rgba(26, 35, 126, 0.2);
        }

        .results {
            margin-top: 40px;
            display: none;
        }

        .results.show {
            display: block;
        }

        .result-card {
            background: linear-gradient(135deg, #e8eaf6 0%, #c5cae9 100%);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 20px;
            border: 2px solid #3949ab;
        }

        .result-title {
            font-size: 1.8em;
            color: #1a237e;
            margin-bottom: 20px;
            text-align: center;
        }

        .cost-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .cost-item {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #3949ab;
        }

        .cost-label {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 8px;
        }

        .cost-value {
            font-size: 1.5em;
            font-weight: 700;
            color: #1a237e;
        }

        .total-cost {
            background: linear-gradient(135deg, #1a237e 0%, #3949ab 100%);
            color: white;
            font-size: 2.5em;
            font-weight: 700;
            text-align: center;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
            box-shadow: 0 10px 30px rgba(26, 35, 126, 0.4);
        }

        .info-box {
            background: #e3f2fd;
            border-left: 5px solid #2196f3;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .toggle-presets {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .preset-btn {
            padding: 10px 20px;
            background: #1a237e;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.95em;
            transition: background 0.3s;
        }

        .preset-btn:hover {
            background: #3949ab;
        }

        /* Style pour bouton preset s√©lectionn√© (sauf R√©initialiser) */
        .preset-btn.preset-selected {
            border: 3px solid #ffeb3b; /* jaune */
            box-shadow: 0 0 10px rgba(255,235,59,0.35);
            background: #1f2b7a;
        }

        .hourly-table {
            width: 100%;
            margin-top: 30px;
            border-collapse: collapse;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .hourly-table th {
            background: linear-gradient(135deg, #1a237e 0%, #3949ab 100%);
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }

        .hourly-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        .hourly-table tr:hover {
            background: #e8eaf6;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            .hour-grid {
                grid-template-columns: repeat(6, 1fr);
                gap: 5px;
            }

            .hour-input {
                padding: 5px 1px;
                font-size: 0.8em;
            }

            .hour-label {
                font-size: 0.7em;
            }

            .week-schedule {
                grid-template-columns: 1fr;
                gap: 12px;
            }

            .day-card {
                padding: 15px 12px;
            }

            .calculate-container {
                flex-direction: column;
            }

            .back-button {
                top: 20px;
                right: 20px;
            }
        }
    </style>
</head>
<body>
    <div id="mobileBlock" class="mobile-block-overlay" role="dialog" aria-modal="true" aria-hidden="true">
        <div class="message">
            <h2>Acc√®s restreint aux grands √©crans</h2>
            <p>Cette application est r√©serv√©e √† un affichage sur grand √©cran (bureau). Veuillez utiliser un ordinateur de bureau ou un √©cran plus large.</p>
            <p style="margin-top:12px; font-size:0.95em; color:#666;">Largeur minimale requise : 1024px</p>
        </div>
    </div>
    <div class="container">
        <a href="https://simulateur-devis-allo-bot.vercel.app/" class="back-button">‚Üê Retour</a>
        <h1>
            <a href="#" aria-label="ALLO-BOT logo"><img src="https://i.ibb.co/NdQ86r88/ia.png" alt="ALLO-BOT" class="header-logo"></a>
            SIMULATEUR DE DEVIS ALLO-BOT : PLAN PROMAX
        </h1>
        <p class="promo-subtitle">Des tarifs de communications autour de 02 (deux) FCFA par minute et avec une capacit√© native de concurrence illimit√©e d'appels simultan√©s.</p>
        <p class="subtitle">Agent Vocal IA - Analyse Compl√®te des Co√ªts Mensuels</p>

        <!-- Concepts Cl√©s (Neurons & Tokens) -->
        <div class="config-section" style="background: #e3f2fd; border-left: 4px solid #2196f3;">
            <h2 class="section-title">üìö Concepts Cl√©s</h2>

            <div class="pricing-info" style="margin-bottom: 20px;">
                <h3>üß† Neurons</h3>
                <p>Unit√© de calcul utilis√©e pour les offres gratuites. Chaque service consomme des Neurons diff√©remment :</p>
                <ul style="margin-top: 5px; margin-left: 20px;">
                    <li><strong>10 000 Neurons gratuits par jour</strong> (renouvel√©s quotidiennement)</li>
                    <li>Consommation approximative :
                        <ul style="margin-left: 20px;">
                            <li>STT (Reconnaissance vocale) : ~0,33 Neurons/seconde</li>
                            <li>TTS (Synth√®se vocale) : ~0,31 Neurons/seconde</li>
                            <li>LLM (Mod√®le de langage) : ~2,46 Neurons / 1 000 tokens</li>
                        </ul>
                    </li>
                </ul>
                <div style="margin-top:10px; background:#fff3e0; padding:10px; border-radius:6px; border-left:4px solid #ff9800;">
                    <strong>‚ö†Ô∏è Remarque importante :</strong> Les <strong>10 000 Neurons/jour</strong> sont partag√©s entre les services <em>STT, LLM et TTS</em> (pas de quota individuel). Si la consommation totale journali√®re d√©passe cette tranche freemium, le surplus est factur√© et s'applique au total de consommation combin√©e.
                </div>
            </div>

            <div class="pricing-info">
                <h3>üî§ Tokens</h3>
                <p>Unit√© de base du traitement du langage. En fran√ßais, <strong>1 token ‚âà 4 caract√®res</strong> ou ‚âà 0,75 mot.</p>

                <div style="background: white; padding: 15px; border-radius: 8px; margin-top: 10px; border: 1px solid #e0e0e0;">
                    <h4>Exemple de conversation (‚âà 50 tokens) :</h4>
                    <div style="display: grid; grid-template-columns: auto 1fr; gap: 10px; margin-top: 10px;">
                        <div style="color: #1976d2;"><strong>Utilisateur:</strong></div>
                        <div>"Bonjour, j'aimerais conna√Ætre mon solde bancaire." (11 tokens)</div>

                        <div style="color: #388e3c;"><strong>Assistant:</strong></div>
                        <div>"Bien s√ªr, je vais v√©rifier votre solde. Un instant s'il vous pla√Æt..." (14 tokens)</div>

                        <div style="color: #1976d2;"><strong>Utilisateur:</strong></div>
                        <div>"Merci." (1 token)</div>

                        <div style="color: #388e3c;"><strong>Assistant:</strong></div>
                        <div>"Votre solde actuel est de 1 245,50 ‚Ç¨. Puis-je faire autre chose pour vous ?" (16 tokens)</div>
                    </div>
                    <div style="margin-top: 10px; font-size: 0.9em; color: #666;">
                        <strong>Total :</strong> ~42 tokens (‚âà 84 tokens avec le contexte syst√®me)
                    </div>
                </div>

                <div style="margin-top: 15px; background: #fff8e1; padding: 15px; border-radius: 5px; border-left: 3px solid #ffc107;">
                    <strong>üí° Astuces de calcul :</strong>
                    <ul style="margin: 8px 0 0 15px;">
                        <li>1 000 tokens ‚âà 1 page de texte (‚âà 750 mots)</li>
                        <li>Conversation typique : 50-200 tokens/√©change</li>
                        <li>1 000 tokens ‚âà 2 460 Neurons (mod√®le gratuit)</li>
                        <li>Avec 10k Neurons/jour : ‚âà 4 065 tokens gratuits</li>
                    </ul>
                </div>

            </div>
        </div>

        <!-- Configuration TTS -->
        <div class="config-section">
            <h2 class="section-title">üéôÔ∏è Configuration Text-to-Speech (TTS)</h2>
            
            <div class="input-group">
                <label>Fournisseur TTS</label>
                <select id="ttsProvider">
                    <option value="cf-melotts">cf/melotts ‚Äî 7,21 FCFA/min / 0,013 $/min (Freemium via Neurons)</option>
                    <option value="google-tts">Google Cloud TTS ‚Äî ~8,14 FCFA/min / ~0,014 $/min (1M caract√®res/mois gratuits)</option>
                    <option value="cartesia">Cartesia ‚Äî ~16,89 FCFA/min / ~0,030 $/min (Plan payant requis)</option>
                    <option value="elevenlabs">ElevenLabs ‚Äî ~33,90 FCFA/min / ~0,060 $/min (10k caract√®res/mois gratuits)</option>
                </select>
            </div>



            <div class="pricing-info">
                <strong>‚ÑπÔ∏è Informations TTS:</strong>
                 <div style="margin-top:10px;">
                     <table style="width:100%; border-collapse:collapse; font-size:0.95em;">
                         <thead>
                             <tr style="text-align:left; border-bottom:1px solid #e0e0e0;">
                                 <th style="padding:8px 6px; width:30%">Service / Mod√®le</th>
                                 <th style="padding:8px 6px; width:35%">Tarif (FCFA / USD)</th>
                                 <th style="padding:8px 6px; width:35%">Offre Freemium</th>
                             </tr>
                         </thead>
                         <tbody>
                             <tr>
                                 <td style="padding:8px 6px;">cf/melotts</td>
                                 <td style="padding:8px 6px;">~7,21 FCFA/min / 0,013 $/min</td>
                                 <td style="padding:8px 6px;">Inclus dans les 10 000 Neurons/jour partag√©s</td>
                             </tr>
                             <tr>
                                 <td style="padding:8px 6px;">Google Cloud TTS</td>
                                 <td style="padding:8px 6px;">~8,14 FCFA/min / ~0,014 $/min</td>
                                 <td style="padding:8px 6px;">1M caract√®res/mois gratuits (voix standard)</td>
                             </tr>
                             <tr>
                                 <td style="padding:8px 6px;">Cartesia</td>
                                 <td style="padding:8px 6px;">~16,89 FCFA/min / ~0,030 $/min</td>
                                 <td style="padding:8px 6px;">Plan payant requis pour une utilisation significative</td>
                             </tr>
                             <tr>
                                 <td style="padding:8px 6px;">ElevenLabs</td>
                                 <td style="padding:8px 6px;">~33,90 FCFA/min / ~0,060 $/min</td>
                                 <td style="padding:8px 6px;">10 000 caract√®res/mois gratuits</td>
                             </tr>
                         </tbody>
                     </table>
                 </div>
            </div>
        </div>
        <!-- Configuration STT -->
        <div class="config-section">
            <h2 class="section-title">üé§ Configuration Speech-to-Text (STT)</h2>
            
            <div class="input-group">
                <label>Fournisseur STT</label>
                <select id="sttProvider">
                    <option value="cf-whisper">cf/openai/whisper ‚Äî ~0,28 FCFA/min / ~0,0005 $/min (Freemium via Neurons)</option>
                    <option value="assemblyai">AssemblyAI ‚Äî ~1,41 FCFA/min / ~0,0025 $/min (~5h/mois gratuites)</option>
                    <option value="deepgram">Deepgram ‚Äî ~2,26 FCFA/min / ~0,004 $/min (Cr√©dits gratuits au d√©part)</option>
                    <option value="google-stt">Google Cloud STT ‚Äî ~2,26 FCFA/min / ~0,004 $/min (60 min/mois gratuites)</option>
                </select>
            </div>

            <div class="pricing-info">
                <strong>‚ÑπÔ∏è Informations STT:</strong>
                <div style="margin-top:10px;">
                    <table style="width:100%; border-collapse:collapse; font-size:0.95em;">
                        <thead>
                            <tr style="text-align:left; border-bottom:1px solid #e0e0e0;">
                                <th style="padding:8px 6px; width:30%">Service / Mod√®le</th>
                                <th style="padding:8px 6px; width:35%">Tarif (FCFA / USD)</th>
                                <th style="padding:8px 6px; width:35%">Offre Freemium</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                 <td style="padding:8px 6px;">cf/openai/whisper</td>
                                 <td style="padding:8px 6px;">~0,28 FCFA/min / ~0,0005 $/min</td>
                                 <td style="padding:8px 6px;">Inclus dans les 10 000 Neurons/jour partag√©s</td>
                             </tr>
                             <tr>
                                 <td style="padding:8px 6px;">AssemblyAI</td>
                                 <td style="padding:8px 6px;">~1,41 FCFA/min / ~0,0025 $/min</td>
                                 <td style="padding:8px 6px;">~5 heures/mois gratuites</td>
                             </tr>
                             <tr>
                                 <td style="padding:8px 6px;">Deepgram</td>
                                 <td style="padding:8px 6px;">~2,26 FCFA/min / ~0,004 $/min</td>
                                 <td style="padding:8px 6px;">Cr√©dits gratuits au d√©part</td>
                             </tr>
                             <tr>
                                 <td style="padding:8px 6px;">Google Cloud STT</td>
                                 <td style="padding:8px 6px;">~2,26 FCFA/min / ~0,004 $/min</td>
                                 <td style="padding:8px 6px;">60 minutes/mois gratuites</td>
                             </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Configuration LLM -->
        <div class="config-section">
            <h2 class="section-title">ü§ñ Configuration Mod√®le de Langage (LLM)</h2>
            
            <div class="input-group">
                <label>Mod√®le LLM</label>
                <select id="llmModel">
                    <option value="llama3-1b">Llama 3.2-1B ‚Äî ~62 FCFA/1M tokens / ~0,11 $/1M tokens (Freemium via Neurons)</option>
                    <option value="cf-llama2-7b">cf/meta/llama-2-7b ‚Äî ~62 FCFA/1M tokens / ~0,11 $/1M tokens (Freemium via Neurons)</option>
                    <option value="cf-llama2-13b">cf/meta/llama-2-13b ‚Äî ~107 FCFA/1M tokens / ~0,19 $/1M tokens (Freemium via Neurons)</option>
                    <option value="gemini-pro">Google Gemini Pro ‚Äî ~282 FCFA/1M tokens / ~0,50 $/1M tokens (60 req/min gratuites)</option>
                    <option value="gpt4o-mini">GPT-4o mini ‚Äî ~424 FCFA/1M tokens / ~0,75 $/1M tokens (Payant)</option>
                    <option value="gpt4o">GPT-4o ‚Äî ~5650 FCFA/1M tokens / ~10 $/1M tokens (Payant)</option>
                </select>
            </div>

            <div class="pricing-info">
                <strong>‚ÑπÔ∏è Informations LLM:</strong>
                <div style="margin-top:8px; font-size:0.95em; color:#333;">Co√ªt bas√© sur les tokens ‚Äî on peut distinguer Entr√©e (Input) et Sortie (Output). 1 token ‚âà 4 caract√®res en fran√ßais.</div>
                <div style="margin-top:10px;">
                    <table style="width:100%; border-collapse:collapse; font-size:0.9em;">
                        <thead>
                            <tr style="text-align:left; border-bottom:1px solid #e0e0e0;">
                                <th style="padding:8px 6px; width:30%">Mod√®le</th>
                                <th style="padding:8px 6px; width:35%">Tarif Agr√©g√© (FCFA / USD) par 1M de tokens</th>
                                <th style="padding:8px 6px; width:35%">Offre Freemium</th>
                            </tr>
                        </thead>
                        <tbody>
                             <tr style="background-color: #f9f9f9;">
                                 <td style="padding:8px 6px;">Llama 3.2-1B / cf/meta/llama-2-7b</td>
                                 <td style="padding:8px 6px;">~62 FCFA/1M tokens / ~0,11 $/1M tokens</td>
                                 <td style="padding:8px 6px;">Inclus dans les 10 000 Neurons/jour partag√©s</td>
                             </tr>
                             <tr>
                                 <td style="padding:8px 6px;">cf/meta/llama-2-13b</td>
                                 <td style="padding:8px 6px;">~107 FCFA/1M tokens / ~0,19 $/1M tokens</td>
                                 <td style="padding:8px 6px;">Inclus dans les 10 000 Neurons/jour partag√©s</td>
                             </tr>
                             <tr style="background-color: #f9f9f9;">
                                 <td style="padding:8px 6px;">Google Gemini Pro</td>
                                 <td style="padding:8px 6px;">~282 FCFA/1M tokens / ~0,50 $/1M tokens</td>
                                 <td style="padding:8px 6px;">60 requ√™tes/minute gratuites</td>
                             </tr>
                             <tr>
                                 <td style="padding:8px 6px;">GPT-4o mini</td>
                                 <td style="padding:8px 6px;">~424 FCFA/1M tokens / ~0,75 $/1M tokens</td>
                                 <td style="padding:8px 6px;">Aucune (Payant)</td>
                             </tr>
                             <tr style="background-color: #f9f9f9;">
                                 <td style="padding:8px 6px;">GPT-4o</td>
                                 <td style="padding:8px 6px;">~5650 FCFA/1M tokens / ~10 $/1M tokens</td>
                                 <td style="padding:8px 6px;">Aucune (Payant)</td>
                             </tr>
                        </tbody>
                    </table>
                </div>
                <div style="margin-top:8px; font-size:0.9em; color:#666;">Note : le simulateur utilise actuellement des tarifs agr√©g√©s (FCFA / 1k tokens) pour le calcul. Si vous voulez que j'impl√©mente la s√©paration Entr√©e/Sortie (USD ‚Üí FCFA) dans la logique de calcul, je peux le faire (ajout d'objets tarifaires et adaptation de calculateCosts).</div>
            </div>
        </div>

        <!-- Stockage Cloud -->
        <div class="config-section">
            <h2 class="section-title">üíæ Stockage Cloud</h2>
            
            <div class="pricing-info success">
                <strong>‚úÖ Forfait de base inclus:</strong>
                <ul style="margin-top: 10px; margin-left: 20px;">
                    <li><strong>10 millions de requ√™tes API</strong> (au-del√†: 197 FCFA/million)</li>
                    <li><strong>Base de donn√©es:</strong> 25 milliards de lectures (au-del√†: 0,66 FCFA/million)</li>
                    <li><strong>Cache:</strong> 10 millions de lectures (au-del√†: 328 FCFA/million)</li>
                    <li><strong>Stockage fichiers:</strong> 10 Go gratuit (au-del√†: 9,84 FCFA/Go)</li>
                    <li><strong>Objets durables:</strong> 1 million de requ√™tes (au-del√†: 98,40 FCFA/million)</li>
                </ul>
            </div>

            <div class="storage-config">
                <div class="input-group">
                    <label>
                        Stockage Fichiers - Corpus RAG (Go)
                        <span class="free-tier-badge">10 Go gratuits</span>
                    </label>
                    <input type="number" id="r2Storage" value="10" min="0" max="1000" step="1">
                    <div class="pricing-info">
                        <strong>Tarif au-del√† de 10 Go:</strong> 9,84 FCFA/Go/mois
                    </div>
                </div>

                <div class="input-group">
                    <label>
                        Base de Donn√©es - Conversations (Go)
                        <span class="free-tier-badge">5 Go gratuits</span>
                    </label>
                    <input type="number" id="d1Storage" value="5" min="0" max="500" step="0.5">
                    <div class="pricing-info">
                        <strong>Tarif au-del√† de 5 Go:</strong> 492 FCFA/Go/mois
                    </div>
                </div>

                <div class="input-group">
                    <label>
                        Cache - Nombre de cl√©s (millions)
                        <span class="free-tier-badge">10M lectures gratuites</span>
                    </label>
                    <input type="number" id="kvKeys" value="5" min="0" max="100" step="0.5">
                    <div class="pricing-info">
                        <strong>Lectures au-del√† de 10M:</strong> 328 FCFA/million<br>
                        <strong>√âcritures:</strong> 3.280 FCFA/million
                    </div>
                </div>

                <div class="input-group">
                    <label>
                        Objets Durables - Requ√™tes (millions)
                        <span class="free-tier-badge">1M gratuit</span>
                    </label>
                    <input type="number" id="durableRequests" value="2" min="0" max="100" step="0.5">
                    <div class="pricing-info">
                        <strong>Au-del√† de 1M:</strong> 98,40 FCFA/million de requ√™tes<br>
                        <strong>Dur√©e:</strong> 8.200 FCFA/million GB-s
                    </div>
                </div>
            </div>
        </div>

        <!-- Plage de temps (anciennement Configuration G√©n√©rale) -->
        <div class="config-section">
            <h2 class="section-title">‚öôÔ∏è Plage de temps</h2>
            
            <div class="input-group">
                <label>Dur√©e moyenne d'un appel (minutes)</label>
                <input type="number" id="callDuration" value="3" min="1" max="60" step="0.5">
            </div>

            <div class="input-group">
                <label>Temps de pause par d√©faut (% de l'heure)</label>
                <input type="number" id="defaultPauseTime" value="50" min="0" max="100" step="5" onchange="updateAllPauseTimes()">
            </div>

            <div class="input-group">
                <label>Jours ouvr√©s par mois</label>
                <input type="number" id="workingDays" value="22" min="1" max="31">
            </div>
        </div>



        
        <div class="config-section" id="planningSection">
            <h2 class="section-title">üìÖ Planning des Utilisateurs Simultan√©s</h2>
            
            <div class="info-box">
                <strong>üí° Astuce:</strong> D√©finissez le nombre moyen d'utilisateurs simultan√©s pour chaque heure de chaque jour.
            </div>

            <div class="toggle-checkbox">
                <input type="checkbox" id="enableWeeklyMode" onchange="toggleWeeklyMode()">
                <label for="enableWeeklyMode">üìÜ Activer le mode 4 semaines (planning d√©taill√©)</label>
            </div>

            <div class="toggle-presets">
                <button class="preset-btn" data-preset="standard" onclick="applyPreset('standard')">üìä Standard</button>
                <button class="preset-btn" data-preset="callcenter" onclick="applyPreset('callcenter')">üìû Call Center</button>
                <button class="preset-btn" data-preset="support" onclick="applyPreset('support')">üîß Support 24/7</button>
                <button class="preset-btn" data-preset="commerce" onclick="applyPreset('commerce')">üõí E-Commerce</button>
                <button class="preset-btn" data-preset="zero" onclick="applyPresetToAllWeeks('zero')">üîÑ R√©initialiser</button>
            </div>

            <div id="scheduleContainer" class="schedule-container"></div>
        </div>

        <div class="calculate-container">
            <button class="btn-calculate" onclick="calculateCosts()">üîç Calculer les Co√ªts</button>
            <div class="monthly-fee">
                + Redevance mensuelle au service ALLO-BOT = 15.000 FCFA
            </div>
        </div>

        <!-- R√©sultats -->
        <div class="results" id="results">
            <div class="result-card">
                <h3 class="result-title">üìä R√©sum√© Mensuel Estim√©</h3>
                <div class="cost-breakdown" id="costBreakdown"></div>
                <div class="total-cost" id="totalCost"></div>
            </div>

            <div class="result-card">
                <h3 class="result-title">üìà M√©triques Cl√©s</h3>
                <div class="cost-breakdown" id="metricsBreakdown"></div>
            </div>

            <div class="result-card">
                <h3 class="result-title">‚è∞ D√©tail par Tranche Horaire</h3>
                <table class="hourly-table" id="hourlyTable"></table>
            </div>
        </div>

    <div class="cost-breakdown">
            <div class="cost-item">
                <div class="cost-label">Plateforme AI ‚Äî Services d'infrastructure et mod√®les pr√©sents sur la plateforme</div>
                <div class="cost-value">Mod√®le de tarification : 10 000 Neurons / jour gratuits, puis 0,011 USD / 1 000 Neurons</div>
                <div style="margin-top:10px; font-size:0.95em; color:#333;">Page de tarification principale :</div>
                <div style="margin-top:6px;"><a href="https://developers.cloudflare.com/workers-ai/platform/pricing/" target="_blank" rel="noopener">https://developers.cloudflare.com/workers-ai/platform/pricing/</a></div>
                <div style="margin-top:8px; font-size:0.95em; color:#666;">Mod√®les pr√©sents sur la plateforme (exemples) :</div>
                <div style="margin-top:6px; font-size:0.95em; color:#1a237e;">STT : cf/openai/whisper, cf/deepgram/nova-3, cf/deepgram/flux</div>
                <div style="margin-top:4px; font-size:0.95em; color:#1a237e;">LLM : cf/meta/llama-3.1-8b-instruct, cf/mistral/mixtral-8x7b-instruct-v0.1, cf/google/gemma-7b-it</div>
                <div style="margin-top:4px; font-size:0.95em; color:#1a237e;">TTS : cf/myshell-ai/melotts</div>
                <div style="margin-top:8px; font-size:0.95em; color:#444;">Note : tous les mod√®les pr√©sents sur Cloudflare b√©n√©ficient de la tranche freemium (10 000 Neurons/jour partag√©s) ; ce n'est pas limit√© au premier mod√®le list√©.</div>
            </div>

            <div class="cost-item">
                <div class="cost-label">Services Partenaires ‚Äî TTS & Clonage de voix</div>
                <div style="margin-top:6px;"><strong>ElevenLabs</strong> ‚Äî <a href="https://elevenlabs.io/pricing" target="_blank" rel="noopener">https://elevenlabs.io/pricing</a></div>
                <div style="margin-top:6px;"><strong>Cartesia</strong> ‚Äî <a href="https://cartesia.ai/pricing" target="_blank" rel="noopener">https://cartesia.ai/pricing</a></div>
                <div style="margin-top:8px; font-size:0.9em; color:#666;">Ces services sont externes et disposent de leurs propres plans tarifaires pour le clonage de voix et la synth√®se haute fid√©lit√©.</div>
            </div>

            <div class="cost-item">
                <div class="cost-label">Autres fournisseurs & mod√®les mentionn√©s</div>
                <div style="margin-top:6px;"><strong>OpenAI</strong> ‚Äî <a href="https://openai.com/api/pricing/" target="_blank" rel="noopener">https://openai.com/api/pricing/</a></div>
                <div style="margin-top:6px;"><strong>Deepgram</strong> ‚Äî <a href="https://deepgram.com/pricing" target="_blank" rel="noopener">https://deepgram.com/pricing</a></div>
                <div style="margin-top:6px;"><strong>AssemblyAI</strong> ‚Äî <a href="https://www.assemblyai.com/pricing" target="_blank" rel="noopener">https://www.assemblyai.com/pricing</a></div>
                <div style="margin-top:8px; font-size:0.9em; color:#666;">Ces liens sont fournis √† titre de consultation pour les tarifs et limitations des fournisseurs externes que vous pouvez int√©grer.</div>
            </div>
        </div>
        
        <!-- Images ajout√©es en bas de page -->
        <div class="footer-images">
            <img src="https://i.ibb.co/1YjdzfTj/Copie-de-Copie-de-Beige-Modern-Product-Sales-Bar-Chart-Graph-1-1.png" alt="Graph banner">
            <img src="https://i.ibb.co/0pr6Dq6Y/11.png" alt="Logo small">
        </div>
        <div class="footer-contact">SELI IA MASTER AGENCY &nbsp;&nbsp; +226 56888879 (Whatsapp) &nbsp;&nbsp; Situ√© √† 800 m√®tres du Palace Hotel</div>
    </div>

    <script>
    // Bloque l'acc√®s sur mobile (seuil largeur desktop)
    (function(){
        const MIN_DESKTOP_WIDTH = 1024;
        function updateOverlay(){
            const overlay = document.getElementById('mobileBlock');
            if(!overlay) return;
            if(window.innerWidth < MIN_DESKTOP_WIDTH){
                overlay.classList.add('visible');
                overlay.setAttribute('aria-hidden','false');
                document.documentElement.style.overflow = 'hidden';
            } else {
                overlay.classList.remove('visible');
                overlay.setAttribute('aria-hidden','true');
                document.documentElement.style.overflow = '';
            }
        }
        window.addEventListener('resize', updateOverlay);
        document.addEventListener('DOMContentLoaded', updateOverlay);
        updateOverlay();
    })();

    // Configuration des tarifs en FCFA (1 USD ‚âà 565 FCFA utilis√© pour les estimations pr√©sent√©es)
    const EXCHANGE_RATE = 565;
        
        const SERVICE_PRICING = {
            monthly_fee: 15000,              // Redevance ALLO-BOT
            api_requests: 0.30 * EXCHANGE_RATE,    // FCFA/million au-del√† de 10M
            r2_storage: 0.015 * EXCHANGE_RATE,     // FCFA/Go au-del√† de 10 Go
            r2_class_a: 4.50 * EXCHANGE_RATE,      // FCFA/million (write, list)
            r2_class_b: 0.36 * EXCHANGE_RATE,      // FCFA/million (read)
            d1_storage: 0.75 * EXCHANGE_RATE,      // FCFA/Go au-del√† de 5 Go
            d1_reads: 0.001 * EXCHANGE_RATE,       // FCFA/million au-del√† de 25B
            d1_writes: 1.00 * EXCHANGE_RATE,       // FCFA/million au-del√† de 50M
            kv_reads: 0.50 * EXCHANGE_RATE,        // FCFA/million au-del√† de 10M
            kv_writes: 5.00 * EXCHANGE_RATE,       // FCFA/million
            kv_storage: 0.50 * EXCHANGE_RATE,      // FCFA/Go
            durable_requests: 0.15 * EXCHANGE_RATE, // FCFA/million au-del√† de 1M
            durable_duration: 12.50 * EXCHANGE_RATE, // FCFA/million GB-s
            
            // Limites gratuites
            free_api_requests: 10,       // millions
            free_r2_storage: 10,         // Go
            free_d1_storage: 5,          // Go
            free_d1_reads: 25000,        // millions
            free_d1_writes: 50,          // millions
            free_kv_reads: 10,           // millions
            free_durable_requests: 1,    // million
        };
        const FREE_NEURONS_PER_DAY = 10000;

        const TTS_PRICING = {
            // Tarifs TTS approximatifs (stock√©s en FCFA/min)
            // MeloTTS (melotts) : tarif estim√©
            native: 7.21,                       // 7,21 FCFA / min (~0.013 USD/min)
            'cf-melotts': 7.21,                 // alias pour la valeur s√©lectionn√©e dans le select
            'google-tts': 8.136,                // 0.016 USD/1k chars -> 0.0144 USD/min -> 8.136 FCFA/min
            cartesia: 0.0299 * EXCHANGE_RATE,   // FCFA/min (approx.)
            elevenlabs: 0.06 * EXCHANGE_RATE,   // FCFA/min (approx.)
        };

        const STT_PRICING = {
            // Tarifs en USD convertis ‚Üí stockage en FCFA/min (‚âà 565 FCFA/USD)
            'cf-whisper': 0.0005 * EXCHANGE_RATE,     // ~0,0005 USD/min ‚Üí ~0.28 FCFA/min (inclus dans le seuil Neurons)
            deepgram: 0.004 * EXCHANGE_RATE,    // ~0,004 USD/min ‚Üí ~2.26 FCFA/min
            assemblyai: (0.15/60) * EXCHANGE_RATE, // ~0,15 USD/heure ‚Üí ~0,0025 USD/min ‚Üí ~1.41 FCFA/min
            'google-stt': 0.004 * EXCHANGE_RATE, // ~0,004 USD/min -> ~2.26 FCFA/min
        };

        const LLM_PRICING = {
            // Tarifs agr√©g√©s (FCFA / 1k tokens).
            free: 0,                             // Offre gratuite (0 FCFA)
            // Mod√®les l√©gers
            llama2: (0.11/1000) * EXCHANGE_RATE,           // 0.11 USD / 1M ‚Üí ~62 FCFA / 1M ‚Üí ~0.06215 FCFA / 1k
            'llama2-13b': (0.19/1000) * EXCHANGE_RATE,    // 0.19 USD / 1M ‚Üí ~107 FCFA / 1M ‚Üí ~0.10715 FCFA / 1k
            llama2_13b: (0.19/1000) * EXCHANGE_RATE,
            mistral: (0.11/1000) * EXCHANGE_RATE,
            mixtral: (0.19/1000) * EXCHANGE_RATE,
            'llama3-1b': (0.11/1000) * EXCHANGE_RATE,
            'llama3-1b': (0.11/1000) * EXCHANGE_RATE,
            'cf-llama2-7b': (0.11/1000) * EXCHANGE_RATE,
            'cf-llama2-13b': (0.19/1000) * EXCHANGE_RATE,
            // GPT-family (estimation agr√©g√©e Input+Output par 1M tokens)
            'gpt4o-mini': (0.75/1000) * EXCHANGE_RATE,    // 0.15 + 0.60 = 0.75 USD / 1M ‚Üí converti
            'gpt4o': (10.0/1000) * EXCHANGE_RATE,         // 5 + 5 = 10 USD / 1M (Entr√©e+Sortie agr√©g√©es)
            'gemini-pro': (0.000125 * 4) * EXCHANGE_RATE, // 0.000125 USD/1k chars -> 0.0005 USD/1k tokens -> ~0.28 FCFA/1k tokens
        };

        // Tarifs sp√©cifiques Input/Output (USD par 1M tokens) pour certains mod√®les
        const LLM_IO_PRICING_USD = {
            'gpt4o-mini': {
                input_per_1M_usd: 0.15,
                output_per_1M_usd: 0.60,
                description: 'GPT-4o mini ‚Äî mod√®le optimis√© pour latence et co√ªts, bon √©quilibre performance/prix.'
            }
            // Vous pouvez ajouter d'autres mod√®les ici avec { input_per_1M_usd, output_per_1M_usd }
        };

        // Co√ªts en Neurons pour les options natives/gratuites
        const NEURONS_COST = {
            tts: 19,    // neurons par minute audio (MeloTTS)
            stt: 20,    // neurons par minute audio (Whisper)
            llm: 2.46,  // neurons par 1000 tokens (Llama 3.2-1B)
            cost_per_1000_neurons: 0.011 * EXCHANGE_RATE // Co√ªt pour 1000 neurons au-del√† du quota
        };

        const DAYS = ['Lundi', 'Mardi', 'Mercredi', 'Jeudi', 'Vendredi', 'Samedi', 'Dimanche'];
        let weeklyModeEnabled = false;

        // Initialisation de l'interface
        function initializeSchedule() {
            const container = document.getElementById('scheduleContainer');
            container.innerHTML = '';

            if (weeklyModeEnabled) {
                // Mode 4 semaines
                for (let week = 1; week <= 4; week++) {
                    const weekContainer = document.createElement('div');
                    weekContainer.className = 'week-container';
                    
                    const weekTitle = document.createElement('div');
                    weekTitle.className = 'week-title';
                    weekTitle.textContent = `üìÖ Semaine ${week}`;
                    weekContainer.appendChild(weekTitle);

                    const scheduleDiv = document.createElement('div');
                    scheduleDiv.className = 'week-schedule';
                    
                    DAYS.forEach((day, dayIndex) => {
                        scheduleDiv.appendChild(createDayCard(day, dayIndex, week));
                    });

                    weekContainer.appendChild(scheduleDiv);
                    container.appendChild(weekContainer);
                }
            } else {
                // Mode semaine unique
                const scheduleDiv = document.createElement('div');
                scheduleDiv.className = 'week-schedule';
                
                DAYS.forEach((day, dayIndex) => {
                    scheduleDiv.appendChild(createDayCard(day, dayIndex, 0));
                });

                container.appendChild(scheduleDiv);
            }
        }

        function createDayCard(day, dayIndex, week) {
            const dayCard = document.createElement('div');
            dayCard.className = 'day-card';
            
            const dayName = document.createElement('div');
            dayName.className = 'day-name';
            dayName.textContent = day;
            dayCard.appendChild(dayName);

            const hourGrid = document.createElement('div');
            hourGrid.className = 'hour-grid';

            // Cr√©er 24 inputs pour chaque heure
            for (let hour = 0; hour < 24; hour++) {
                const hourSlot = document.createElement('div');
                hourSlot.className = 'hour-slot';

                const hourLabel = document.createElement('div');
                hourLabel.className = 'hour-label';
                hourLabel.textContent = `${hour}h`;
                hourSlot.appendChild(hourLabel);

                const inputId = `${week ? 'w' + week + '_' : ''}day${dayIndex}_hour${hour}`;

                // (label '% pause' plac√© sous la cellule horaire plus bas)

                // Champ d'appels simultan√©s (affich√© en premier dans la cellule)
                const input = document.createElement('input');
                input.type = 'text';
                input.className = 'hour-input';
                input.id = inputId;
                input.value = '0';
                input.title = `${day} - ${hour}h:00 - Nombre d'appels simultan√©s`;
                input.inputMode = 'numeric';
                input.pattern = '[0-9]*';
                input.maxLength = 3;
                input.onchange = function() {
                    let val = parseInt(this.value) || 0;
                    if (val < 0) val = 0;
                    this.value = val;
                    calculateCosts();
                };
                hourSlot.appendChild(input);

                // Label '% pause' plac√© entre la case des heures (hourCell) et la case de pause
                const pauseLabel = document.createElement('div');
                pauseLabel.className = 'pause-label';
                pauseLabel.textContent = '% pause';
                hourSlot.appendChild(pauseLabel);

                // Champ de temps de pause (affich√© juste en dessous du label '% pause')
                const pauseInput = document.createElement('input');
                pauseInput.type = 'text';
                pauseInput.className = 'pause-time';
                pauseInput.value = document.getElementById('defaultPauseTime')?.value || '50';
                pauseInput.title = 'Temps de pause (%)';
                pauseInput.id = 'pause_' + inputId;
                pauseInput.onchange = function() {
                    let val = parseInt(this.value) || 0;
                    if (val > 100) val = 100;
                    if (val < 0) val = 0;
                    this.value = val;
                    markPauseAsCustomized(this);
                    calculateCosts();
                };
                hourSlot.appendChild(pauseInput);

                hourGrid.appendChild(hourSlot);
            }

            dayCard.appendChild(hourGrid);
            return dayCard;
        }

        function toggleWeeklyMode() {
            weeklyModeEnabled = document.getElementById('enableWeeklyMode').checked;
            initializeSchedule();
            if (weeklyModeEnabled) {
                applyPresetToAllWeeks('standard');
            } else {
                applyPreset('standard');
            }
        }

        // Profils pr√©-configur√©s partag√©s
        const PRESETS = {
            standard: [
                [0,0,0,0,0,0,0,0,2,4,6,8,8,6,4,3,2,1,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,2,4,6,8,8,6,4,3,2,1,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,2,4,6,8,8,6,4,3,2,1,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,2,4,6,8,8,6,4,3,2,1,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,2,4,6,8,8,6,4,3,2,1,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,1,2,3,3,2,1,1,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
            ],
            callcenter: [
                [0,0,0,0,0,0,0,0,5,10,15,20,20,15,10,8,5,3,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,5,10,15,20,20,15,10,8,5,3,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,5,10,15,20,20,15,10,8,5,3,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,5,10,15,20,20,15,10,8,5,3,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,5,10,15,20,20,15,10,8,5,3,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,3,5,8,8,5,3,2,0,0,0,0,0,0,0,0],
                [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]
            ],
            ecommerce: [
                [0,0,0,0,0,0,0,1,3,5,7,8,7,6,5,4,5,6,7,5,3,2,1,0],
                [0,0,0,0,0,0,0,1,3,5,7,8,7,6,5,4,5,6,7,5,3,2,1,0],
                [0,0,0,0,0,0,0,1,3,5,7,8,7,6,5,4,5,6,8,6,4,2,1,0],
                [0,0,0,0,0,0,0,1,3,5,7,8,7,6,5,4,5,6,7,5,3,2,1,0],
                [0,0,0,0,0,0,0,1,3,5,7,8,7,6,5,4,5,7,9,7,5,3,2,1,0],
                [0,0,0,0,0,0,0,0,2,4,6,8,9,8,7,6,7,8,9,7,5,3,2,1],
                [0,0,0,0,0,0,0,0,1,3,5,7,8,7,6,5,6,7,6,4,3,2,1,0]
            ],
            // Support 24/7 : activit√© r√©partie faible √† mod√©r√©e sur 24h
            support: [
                [1,1,1,1,1,1,1,1,2,3,4,5,5,4,3,3,2,2,1,1,1,1,1,1],
                [1,1,1,1,1,1,1,1,2,3,4,5,5,4,3,3,2,2,1,1,1,1,1,1],
                [1,1,1,1,1,1,1,1,2,3,4,5,5,4,3,3,2,2,1,1,1,1,1,1],
                [1,1,1,1,1,1,1,1,2,3,4,5,5,4,3,3,2,2,1,1,1,1,1,1],
                [1,1,1,1,1,1,1,1,2,3,4,5,5,4,3,3,2,2,1,1,1,1,1,1],
                [1,1,1,1,1,1,1,1,1,2,3,4,4,3,2,2,1,1,1,1,1,1,1,1],
                [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
            ],
            zero: Array(7).fill(Array(24).fill(0))
        };

        // alias pour le bouton 'commerce' qui appelle 'commerce' mais preset s'appelle 'ecommerce'
        PRESETS.commerce = PRESETS.ecommerce;

        function applyPreset(preset) {
            const data = PRESETS[preset];
            if (data) {
                const prefix = weeklyModeEnabled ? 'w1_' : '';
                const defaultPauseTime = document.getElementById('defaultPauseTime')?.value || '50';

                data.forEach((day, dayIndex) => {
                    day.forEach((value, hour) => {
                        // Met √† jour uniquement le nombre d'appels
                        const element = document.getElementById(`${prefix}day${dayIndex}_hour${hour}`);
                        if (element) {
                            element.value = value;
                        }
                        // R√©initialise le temps de pause √† la valeur par d√©faut uniquement si c'est un preset 'zero'
                        if (preset === 'zero') {
                            const pauseElement = document.getElementById(`pause_${prefix}day${dayIndex}_hour${hour}`);
                            if (pauseElement) {
                                pauseElement.value = defaultPauseTime;
                                pauseElement.removeAttribute('data-customized');
                            }
                        }
                    });
                });
            }
            // Mettre en surbrillance le preset s√©lectionn√© (sauf 'zero')
            highlightPreset(preset);
        }

        function applyPresetToAllWeeks(preset) {
            applyPreset(preset);
            if (weeklyModeEnabled) {
                const defaultPauseTime = document.getElementById('defaultPauseTime')?.value || '50';
                for (let week = 2; week <= 4; week++) {
                    const data = PRESETS[preset] || PRESETS.standard;
                    data.forEach((day, dayIndex) => {
                        day.forEach((value, hour) => {
                            // Met √† jour uniquement le nombre d'appels
                            const element = document.getElementById(`w${week}_day${dayIndex}_hour${hour}`);
                            if (element) {
                                element.value = value;
                            }
                            // R√©initialise le temps de pause √† la valeur par d√©faut uniquement si c'est un preset 'zero'
                            if (preset === 'zero') {
                                const pauseElement = document.getElementById(`pause_w${week}_day${dayIndex}_hour${hour}`);
                                if (pauseElement) {
                                    pauseElement.value = defaultPauseTime;
                                    pauseElement.removeAttribute('data-customized');
                                }
                            }
                        });
                    });
                }
            }
            // Mettre en surbrillance le preset s√©lectionn√© (sauf 'zero')
            highlightPreset(preset);
        }

        // Highlight UI for preset buttons (skip reset 'zero')
        function highlightPreset(preset) {
            const buttons = document.querySelectorAll('.preset-btn');
            buttons.forEach(btn => {
                const p = btn.getAttribute('data-preset');
                if (!p) { btn.classList.remove('preset-selected'); return; }
                if (preset === 'zero') {
                    btn.classList.remove('preset-selected');
                } else {
                    if (p === preset) {
                        btn.classList.add('preset-selected');
                    } else {
                        btn.classList.remove('preset-selected');
                    }
                }
            });
        }

        // Calculer les co√ªts
        // Fonction pour mettre √† jour tous les temps de pause
        function updateAllPauseTimes() {
            const defaultPause = parseInt(document.getElementById('defaultPauseTime').value) || 50;
            const inputs = document.querySelectorAll('.pause-time');
            inputs.forEach(input => {
                if (!input.dataset.customized) {
                    input.value = defaultPause;
                }
            });
            calculateCosts();
        }

        // Fonction pour marquer un temps de pause comme personnalis√©
        function markPauseAsCustomized(input) {
            input.dataset.customized = 'true';
        }

        function calculateCosts() {
            console.log('calculateCosts invoked');
            try {
            // Lire et valider les entr√©es (fallbacks s√©curis√©s)
            let callDuration = parseFloat(document.getElementById('callDuration').value);
            if (!isFinite(callDuration) || callDuration <= 0) { console.warn('callDuration invalide, fallback √† 3'); callDuration = 3; }

            let workingDays = parseInt(document.getElementById('workingDays').value);
            if (!isFinite(workingDays) || workingDays <= 0) { console.warn('workingDays invalide, fallback √† 22'); workingDays = 22; }

            // Temps de pause par d√©faut
            let defaultPauseTime = parseInt(document.getElementById('defaultPauseTime').value);
            if (!isFinite(defaultPauseTime) || defaultPauseTime < 0 || defaultPauseTime > 100) { 
                console.warn('defaultPauseTime invalide, fallback √† 50%'); 
                defaultPauseTime = 50; 
            }

            const ttsProvider = (document.getElementById('ttsProvider') ? document.getElementById('ttsProvider').value : 'native');
            const sttProvider = (document.getElementById('sttProvider') ? document.getElementById('sttProvider').value : 'native');
            const llmProvider = (document.getElementById('llmModel') ? document.getElementById('llmModel').value : 'native');
            const platformLlmModels = ['native', 'llama2', 'llama2-13b', 'mistral', 'mixtral', 'llama3-1b', 'cf-llama2-7b', 'cf-llama2-13b', 'cf-melotts'];
            const llmModel = llmProvider; // Alias pour la clart√©
            const tokensPerConv = 2000; // Valeur par d√©faut (tokens par appel)
            
            // Stockage (valeurs s√©curis√©es)
            const r2Storage = Number(parseFloat(document.getElementById('r2Storage').value) || 0);
            const d1Storage = Number(parseFloat(document.getElementById('d1Storage').value) || 0);
            const kvKeys = Number(parseFloat(document.getElementById('kvKeys').value) || 0);
            const durableRequests = Number(parseFloat(document.getElementById('durableRequests').value) || 0);

            // Collecter les donn√©es horaires
            let totalCalls = 0;
            let hourlyData = [];

            if (weeklyModeEnabled) {
                // Mode 4 semaines
                for (let week = 1; week <= 4; week++) {
                    for (let dayIndex = 0; dayIndex < 7; dayIndex++) {
                        for (let hour = 0; hour < 24; hour++) {
                            const element = document.getElementById(`w${week}_day${dayIndex}_hour${hour}`);
                            const pauseElement = document.getElementById(`pause_w${week}_day${dayIndex}_hour${hour}`);
                            const users = element ? parseInt(element.value) || 0 : 0;
                            const pausePercent = pauseElement ? parseInt(pauseElement.value) || defaultPauseTime : defaultPauseTime;
                            const effectiveMinutes = 60 * (1 - (pausePercent / 100));
                            const callsPerHour = users * (effectiveMinutes / callDuration);
                            
                            hourlyData.push({
                                week: week,
                                day: DAYS[dayIndex],
                                dayIndex: dayIndex,
                                hour: hour,
                                users: users,
                                callsPerHour: callsPerHour
                            });
                        }
                    }
                }
            } else {
                // Mode semaine unique
                for (let dayIndex = 0; dayIndex < 7; dayIndex++) {
                    for (let hour = 0; hour < 24; hour++) {
                        const element = document.getElementById(`day${dayIndex}_hour${hour}`);
                        const pauseElement = document.getElementById(`pause_day${dayIndex}_hour${hour}`);
                        const users = element ? parseInt(element.value) || 0 : 0;
                        const pausePercent = pauseElement ? parseInt(pauseElement.value) || defaultPauseTime : defaultPauseTime;
                        const effectiveMinutes = 60 * (1 - (pausePercent / 100));
                        const callsPerHour = users * (effectiveMinutes / callDuration);
                        
                        hourlyData.push({
                            week: 0,
                            day: DAYS[dayIndex],
                            dayIndex: dayIndex,
                            hour: hour,
                            users: users,
                            callsPerHour: callsPerHour
                        });
                    }
                }
            }

            // Calculer le nombre total d'appels par mois
            let monthlyCalls = 0;
            
            if (weeklyModeEnabled) {
                // En mode 4 semaines, chaque semaine repr√©sente 1 semaine du mois
                hourlyData.forEach(slot => {
                    monthlyCalls += slot.callsPerHour;
                });
            } else {
                // En mode semaine unique, on multiplie par le nombre de semaines
                const weeksPerMonth = workingDays / 5;
                hourlyData.forEach(slot => {
                    const daysMultiplier = slot.dayIndex < 5 ? weeksPerMonth : (workingDays / 22) * 2;
                    monthlyCalls += slot.callsPerHour * daysMultiplier;
                });
            }

            // Garantir nombre fini
            if (!isFinite(monthlyCalls)) monthlyCalls = 0;

            const totalMinutes = monthlyCalls * callDuration;
            const sttMinutes = totalMinutes * 0.5; // 50% du temps = utilisateur parle
            const ttsMinutes = totalMinutes * 0.5; // 50% du temps = IA parle
            const totalTokens = (monthlyCalls && isFinite(monthlyCalls)) ? (monthlyCalls * tokensPerConv / 1000) : 0; // Conversion en milliers

            // Calcul de la consommation de Neurons pour les services de la plateforme (natifs/freemium)
            let totalNeuronsUsed = 0;
            if (sttProvider === 'native') {
                totalNeuronsUsed += sttMinutes * NEURONS_COST.stt;
            }
            if (ttsProvider === 'native') {
                totalNeuronsUsed += ttsMinutes * NEURONS_COST.tts;
            }
            if (platformLlmModels.includes(llmModel)) {
                totalNeuronsUsed += totalTokens * NEURONS_COST.llm;
            }

            // Calcul du co√ªt des Neurons si le quota gratuit est d√©pass√©
            const freeNeuronsPerMonth = FREE_NEURONS_PER_DAY * 30; // Approximation sur 30 jours
            const billableNeurons = Math.max(0, totalNeuronsUsed - freeNeuronsPerMonth);
            const neuronsCost = (billableNeurons / 1000) * NEURONS_COST.cost_per_1000_neurons;

            // Calcul des co√ªts (conversion s√©curis√©e en nombres)
            const costs = {
                monthly_fee: Number(SERVICE_PRICING.monthly_fee) || 0,
                stt: 0,
                tts: 0,
                llm: 0,
                neurons: neuronsCost,
                r2_storage: Math.max(0, Number(r2Storage) - Number(SERVICE_PRICING.free_r2_storage)) * Number(SERVICE_PRICING.r2_storage),
                d1_storage: Math.max(0, Number(d1Storage) - Number(SERVICE_PRICING.free_d1_storage)) * Number(SERVICE_PRICING.d1_storage),
                kv_reads: Math.max(0, Number(kvKeys) - Number(SERVICE_PRICING.free_kv_reads)) * Number(SERVICE_PRICING.kv_reads),
                durable_requests: Math.max(0, Number(durableRequests) - Number(SERVICE_PRICING.free_durable_requests)) * Number(SERVICE_PRICING.durable_requests),
            };

            // Calcul des co√ªts pour les services payants (fournisseurs externes)
            if (sttProvider !== 'native') {
                costs.stt = Number(sttMinutes) * (Number(STT_PRICING[sttProvider]) || 0);
            }
            if (ttsProvider !== 'native') {
                costs.tts = Number(ttsMinutes) * (Number(TTS_PRICING[ttsProvider]) || 0);
            }
            if (!platformLlmModels.includes(llmModel)) {
                costs.llm = Number(totalTokens) * (Number(LLM_PRICING[llmProvider]) !== undefined ? Number(LLM_PRICING[llmProvider]) : Number(LLM_PRICING['native']));
            }


            // Nettoyer et s'assurer que chaque poste est un nombre fini
            Object.keys(costs).forEach(key => {
                if (!isFinite(costs[key]) || costs[key] === null) {
                    console.warn('Co√ªt non fini d√©tect√© pour', key, '-> fallback √† 0');
                    costs[key] = 0;
                }
            });

            // Log d√©taill√© pour v√©rification
            console.log('Sous-co√ªts:', JSON.parse(JSON.stringify(costs)));

            const totalCost = Object.values(costs).reduce((a, b) => Number(a) + Number(b), 0);
            const costPerCall = monthlyCalls ? totalCost / monthlyCalls : 0;
            const costPerMinute = totalMinutes ? totalCost / totalMinutes : 0;

            // Afficher les r√©sultats
            displayResults(costs, totalCost, monthlyCalls, totalMinutes, costPerCall, costPerMinute, ttsProvider, sttProvider, llmModel, hourlyData, callDuration, workingDays);
            } catch (err) {
                console.error('Erreur dans calculateCosts:', err);
                // Afficher une alerte conviviale pour l'IDE si n√©cessaire
                try { alert('Erreur lors du calcul : ' + (err && err.message ? err.message : err)); } catch(e) { /* ignore si alert indisponible */ }
            }
        }

        // Afficher les r√©sultats
        function displayResults(costs, totalCost, monthlyCalls, totalMinutes, costPerCall, costPerMinute, ttsProvider, sttProvider, llmModel, hourlyData, callDuration, workingDays) {
            document.getElementById('results').classList.add('show');

            // D√©terminer les noms d'affichage
            const platformLlmModels = ['native', 'llama2', 'llama2-13b', 'mistral', 'mixtral', 'llama3-1b', 'cf-llama2-7b', 'cf-llama2-13b', 'cf-melotts'];
            const ttsName = (ttsProvider === 'native' || ttsProvider === 'cf-melotts') ? 'MeloTTS' : ttsProvider.toUpperCase();
            const sttName = (sttProvider === 'native' || sttProvider === 'cf-whisper') ? 'cf/whisper' : sttProvider.toUpperCase();
            const llmName = llmModel.toUpperCase();

            // R√©sum√© des co√ªts
            let breakdownHTML = `
                <div class="cost-item">
                    <div class="cost-label">üí∞ Redevance mensuelle ALLO-BOT</div>
                    <div class="cost-value">${costs.monthly_fee.toLocaleString('fr-FR')} FCFA</div>
                </div>
                <div class="cost-item">
                    <div class="cost-label">üé§ Speech-to-Text (${sttName})</div>
                    <div class="cost-value">${costs.stt.toLocaleString('fr-FR', {maximumFractionDigits: 0})} FCFA</div>
                </div>
                <div class="cost-item">
                    <div class="cost-label">üéôÔ∏è Text-to-Speech (${ttsName})</div>
                    <div class="cost-value">${costs.tts.toLocaleString('fr-FR', {maximumFractionDigits: 0})} FCFA</div>
                </div>
                <div class="cost-item">
                    <div class="cost-label">ü§ñ Mod√®le de Langage (${llmName})</div>
                    <div class="cost-value">${costs.llm.toLocaleString('fr-FR', {maximumFractionDigits: 0})} FCFA</div>
                </div>
                <div class="cost-item">
                    <div class="cost-label">üíæ Stockage Fichiers</div>
                    <div class="cost-value">${costs.r2_storage.toLocaleString('fr-FR', {maximumFractionDigits: 0})} FCFA</div>
                </div>
                <div class="cost-item">
                    <div class="cost-label">üóÑÔ∏è Base de Donn√©es</div>
                    <div class="cost-value">${costs.d1_storage.toLocaleString('fr-FR', {maximumFractionDigits: 0})} FCFA</div>
                </div>
                <div class="cost-item">
                    <div class="cost-label">‚ö° Cache (Lectures)</div>
                    <div class="cost-value">${costs.kv_reads.toLocaleString('fr-FR', {maximumFractionDigits: 0})} FCFA</div>
                </div>
                <div class="cost-item">
                    <div class="cost-label">üîß Objets Durables</div>
                    <div class="cost-value">${costs.durable_requests.toLocaleString('fr-FR', {maximumFractionDigits: 0})} FCFA</div>
                </div>
            `;

            if (costs.neurons > 0) {
                breakdownHTML += `
                <div class="cost-item" style="background-color: #fff8e1;">
                    <div class="cost-label">üß† Surplus Neurons (Gratuit d√©pass√©)</div>
                    <div class="cost-value">${costs.neurons.toLocaleString('fr-FR', {maximumFractionDigits: 0})} FCFA</div>
                </div>`;
            }

            document.getElementById('costBreakdown').innerHTML = breakdownHTML;

            document.getElementById('totalCost').innerHTML = `
                Co√ªt Total Mensuel Estim√©<br>
                <span style="font-size: 0.5em; opacity: 0.9; line-height: 1.6;">
                    (ALLO-BOT = ${costs.monthly_fee.toLocaleString('fr-FR')} FCFA) + 
                    (${ttsName} = ${costs.tts.toLocaleString('fr-FR', {maximumFractionDigits: 0})} FCFA) + 
                    (${sttName} = ${costs.stt.toLocaleString('fr-FR', {maximumFractionDigits: 0})} FCFA) + 
                    (${llmName} = ${costs.llm.toLocaleString('fr-FR', {maximumFractionDigits: 0})} FCFA)
                    ${costs.neurons > 0 ? ` + (Neurons = ${costs.neurons.toLocaleString('fr-FR', {maximumFractionDigits: 0})} FCFA)` : ''}
                </span><br>
                = ${totalCost.toLocaleString('fr-FR', {maximumFractionDigits: 0})} FCFA
            `;

            // M√©triques cl√©s
            const metricsHTML = `
                <div class="cost-item">
                    <div class="cost-label">üìû Appels / Mois</div>
                    <div class="cost-value">${Math.round(monthlyCalls).toLocaleString('fr-FR')}</div>
                </div>
                <div class="cost-item">
                    <div class="cost-label">‚è±Ô∏è Minutes Totales / Mois</div>
                    <div class="cost-value">${Math.round(totalMinutes).toLocaleString('fr-FR')}</div>
                </div>
                <div class="cost-item">
                    <div class="cost-label">üíµ Co√ªt / Appel</div>
                    <div class="cost-value">${costPerCall.toLocaleString('fr-FR', {maximumFractionDigits: 2})} FCFA</div>
                </div>
                <div class="cost-item">
                    <div class="cost-label">üí∏ Co√ªt / Minute</div>
                    <div class="cost-value">${costPerMinute.toLocaleString('fr-FR', {maximumFractionDigits: 2})} FCFA</div>
                </div>
                <div class="cost-item">
                    <div class="cost-label">üìÖ Jours Ouvr√©s</div>
                    <div class="cost-value">${workingDays}</div>
                </div>
                <div class="cost-item">
                    <div class="cost-label">‚è≥ Dur√©e Moyenne Appel</div>
                    <div class="cost-value">${callDuration} min</div>
                </div>
            `;
            document.getElementById('metricsBreakdown').innerHTML = metricsHTML;

            // Tableau horaire d√©taill√©
            generateHourlyTable(hourlyData, callDuration, workingDays);

            // Scroll vers les r√©sultats
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        // G√©n√©rer le tableau horaire
        function generateHourlyTable(hourlyData, callDuration, workingDays) {
            const table = document.getElementById('hourlyTable');
            
            let tableHTML = `
                <thead>
                    <tr>
                        ${weeklyModeEnabled ? '<th>Semaine</th>' : ''}
                        <th>Jour</th>
                        <th>Heure</th>
                        <th>Utilisateurs Simultan√©s</th>
                        <th>Appels/Heure</th>
                        ${!weeklyModeEnabled ? '<th>Appels/Mois</th>' : ''}
                    </tr>
                </thead>
                <tbody>
            `;

            // Filtrer uniquement les cr√©neaux avec activit√©
            const activeSlots = hourlyData.filter(slot => slot.users > 0);
            const weeksPerMonth = workingDays / 5;

            activeSlots.forEach(slot => {
                let monthlyCallsForSlot = 0;
                if (!weeklyModeEnabled) {
                    const daysMultiplier = slot.dayIndex < 5 ? weeksPerMonth : (workingDays / 22) * 2;
                    monthlyCallsForSlot = slot.callsPerHour * daysMultiplier;
                }

                tableHTML += `
                    <tr>
                        ${weeklyModeEnabled ? `<td>Semaine ${slot.week}</td>` : ''}
                        <td>${slot.day}</td>
                        <td>${slot.hour}h - ${slot.hour + 1}h</td>
                        <td>${slot.users}</td>
                        <td>${slot.callsPerHour.toFixed(1)}</td>
                        ${!weeklyModeEnabled ? `<td>${monthlyCallsForSlot.toFixed(0)}</td>` : ''}
                    </tr>
                `;
            });

            tableHTML += '</tbody>';
            table.innerHTML = tableHTML;
        }

        // Initialisation au chargement
        window.onload = function() {
            initializeSchedule();
            applyPreset('standard');
            // Attacher un listener au bouton de calcul au cas o√π l'attribut onclick ne serait pas pris en charge par l'aper√ßu IDE
            try {
                const btn = document.querySelector('.btn-calculate');
                if (btn && !btn._calculateListenerAdded) {
                    // Supprimer l'attribut inline onclick pour √©viter double invocation (onclick + addEventListener)
                    try { btn.removeAttribute('onclick'); } catch(e) { /* ignore si non support√© */ }
                    btn.addEventListener('click', calculateCosts);
                    btn._calculateListenerAdded = true;
                }
            } catch (e) {
                console.warn('Impossible d\'attacher le listener calculateCosts :', e);
            }
        };
    </script>
</body>
</html>
